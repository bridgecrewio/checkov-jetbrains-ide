package com.bridgecrew.ui.vulnerabilitiesTree

import com.bridgecrew.results.BaseCheckovResult
import com.bridgecrew.utils.getSeverityIconBySeverity
import javax.swing.Icon

class CheckovVulnerabilityTreeNode(val checkovResult: BaseCheckovResult, override val relativePathNode: String): CheckovTreeNode {


    override fun getNodeIcon(): Icon {
        val severity = checkovResult.severity
        return getSeverityIconBySeverity(severity)
    }

    override fun equals(other: Any?): Boolean {
        return other is CheckovVulnerabilityTreeNode &&
                other.checkovResult.name == checkovResult.name &&
                other.checkovResult.id == checkovResult.id &&
                other.checkovResult.category == checkovResult.category &&
                other.relativePathNode == relativePathNode
    }

    override fun toString(): String {
        return checkovResult.name
    }

    override fun hashCode(): Int {
        var result = checkovResult.hashCode()
        result = 31 * result + relativePathNode.hashCode()
        return result
    }
}