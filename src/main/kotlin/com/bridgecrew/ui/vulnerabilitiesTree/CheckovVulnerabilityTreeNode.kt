package com.bridgecrew.ui.vulnerabilitiesTree

import com.bridgecrew.results.BaseCheckovResult
import com.bridgecrew.results.Severity
import icons.CheckovIcons
import javax.swing.Icon

class CheckovVulnerabilityTreeNode(val checkovResult: BaseCheckovResult): CheckovTreeNode {

    private val iconMap: Map<Severity, Icon> = mapOf(
            Severity.CRITICAL to CheckovIcons.SeverityIcon,
            Severity.HIGH to CheckovIcons.SeverityIcon,
            Severity.MEDIUM to CheckovIcons.ErrorIcon,
            Severity.LOW to CheckovIcons.ErrorIcon,
            Severity.UNKNOWN to CheckovIcons.ErrorIcon
    )

    override fun getNodeIcon(): Icon {
        val severity = checkovResult.severity
        return severity.let { iconMap[it] } ?: CheckovIcons.ErrorIcon
    }

    override fun toString(): String {
        return checkovResult.name
    }
}